
ocamlopt = ../native/4.06.1/bin/ocamlopt.opt
ext = .exe
INCL = 4.06.1
flags = -nodynlink -I $INCL -g -w -a ../jscomp/stubs/ext_basic_hash_stubs.c
rule cc
    command = $ocamlopt -O2  $flags $in -o $out && strip $out
    description = Making $out
# build bspp.exe:  cc bspp.mli bspp.ml
build ../darwin/bsb$ext:  cc $INCL/bsb.mli $INCL/bsb.ml
    flags = $flags -unboxed-types unix.cmxa str.cmxa
build ../darwin/bsb_helper$ext:  cc $INCL/bsb_helper.mli $INCL/bsb_helper.ml
    flags = $flags  -unboxed-types -w -a
build ../darwin/refmt$ext: cc $INCL/refmt_main3.mli $INCL/refmt_main3.ml
    flags = $flags  -w -40-30 -no-alias-deps -I +compiler-libs ocamlcommon.cmxa 
build ../darwin/bsc$ext: cc $INCL/whole_compiler.mli $INCL/whole_compiler.ml    
